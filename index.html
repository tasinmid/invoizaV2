<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoiza | Solven.app</title>
    <meta property="og:image" content="solvenlogo.png">
    <meta property="og:url" content="https://invoiza.solven.app">
    <meta property="og:title" content="Invoiza | Solven.app">
    <meta property="og:description" content="Generate professional invoices quickly and easily with Invoiza by Solven.app.">
    <link href="https://fonts.googleapis.com/css2?family=Asimovian&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/form.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="prereg.css">
    <link rel="icon" id="favicon">
</head>
<body>

    <template id="ot-item-template">
        <div class="invoice-item">
            <button type="button" class="btn-close remove-invoice-item" aria-label="Close"></button>
            <h4>Invoice Item</h4>
            <div class="mb-3">
                <label class="form-label">Name <span class="help-icon-placeholder"></span></label>
                <input type="text" class="form-control" data-field="name" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Description <span class="help-icon-placeholder"></span></label>
                <input type="text" class="form-control" data-field="description">
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label">Quantity <span class="help-icon-placeholder"></span></label>
                    <input type="number" class="form-control" data-field="quantity" value="1" min="1" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">Unit Price <span class="help-icon-placeholder"></span></label>
                    <input type="number" class="form-control" data-field="unitPrice" value="50" min="0" step="50" required>
                </div>
            </div>
        </div>
    </template>

    <template id="mp-item-template">
        <div class="invoice-item">
            <button type="button" class="btn-close remove-invoice-item" aria-label="Close"></button>
            <h4>Invoice Item</h4>
            <div class="mb-3">
                <label class="form-label">Name <span class="help-icon-placeholder"></span></label>
                <input type="text" class="form-control" data-field="name" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Description <span class="help-icon-placeholder"></span></label>
                <input type="text" class="form-control" data-field="description">
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label">Month Duration <span class="help-icon-placeholder"></span></label>
                    <div class="month-selector-container">
                        <div class="selected-months-tags" data-field="monthRange-tags"></div>
                        <div class="dropdown">
                            <button type="button" class="btn btn-primary dropdown-toggle add-month-btn" data-bs-toggle="dropdown"><i class="bi bi-plus-lg me-2"></i>Add Month</button>
                            <ul class="dropdown-menu month-dropdown"></ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">Per Month Cost <span class="help-icon-placeholder"></span></label>
                    <input type="number" class="form-control" data-field="perMonthCost" value="50" min="0" step="50" required>
                </div>
            </div>
        </div>
    </template>

    <div class="container-fluid vh-100 d-flex flex-column p-0">
        <header class="text-center py-3 bg-light">
            <h1 class="display-6 mb-0">Invoiza</h1>
            <p class="m-0 text-muted" style="color: #9112bc;">by <a href="https://solven.app" target="_blank" class="solven-app-link" style="color: inherit; text-decoration: none; font-family: 'Asimovian', cursive;">Solven.app</a></p>
        </header>

        <main class="flex-grow-1 p-4 p-lg-5 overflow-auto">
            <form id="apiForm">
                <div class="row g-4">
                    <!-- Left Column -->
                    <div class="col-lg-5">
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header d-flex align-items-center">
                                <i class="bi bi-layout-text-window-reverse me-2"></i><h5 class="mb-0">Template</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="tp-select" class="form-label">Select Template</label>
                                        <!-- Custom Dropdown Structure -->
                                        <div class="custom-select-wrapper">
                                            <div id="custom-tp-select-trigger" class="form-control custom-select-trigger">
                                                <span id="selected-template-name">Select a template...</span>
                                                <i class="bi bi-chevron-down dropdown-arrow"></i>
                                            </div>
                                            <div id="custom-tp-select-options" class="custom-select-options">
                                                <!-- Options will be populated by JavaScript -->
                                            </div>
                                        </div>
                                        <!-- Original select element (hidden) to hold the actual value for form submission -->
                                        <select id="tp-select" class="form-select d-none"></select>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="position-relative d-inline-block">
                                            <img id="large-template-preview" src="" alt="Template Preview" class="img-fluid rounded" style="display: none; cursor: pointer;">
                                            <i class="bi bi-eye-fill text-white position-absolute top-0 end-0 p-2 rounded-circle bg-dark bg-opacity-75" style="display: none; cursor: pointer;" id="large-template-preview-icon"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card mb-4 shadow-sm">
                            <div class="card-header d-flex align-items-center">
                                <i class="bi bi-person-badge me-2"></i><h5 class="mb-0">Core Details</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="cp" class="form-label">Company Name <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The name of the company issuing the invoice."></i></label>
                                        <input type="text" class="form-control" id="cp" value="Solven App Inc." required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="ad" class="form-label">Address <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The company's physical or mailing address."></i></label>
                                        <input type="text" class="form-control" id="ad" value="123 Innovation Drive" required>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="ph" class="form-label">Phone <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="A contact phone number for the company."></i></label>
                                        <input type="tel" class="form-control" id="ph" value="(555) 123-4567" required pattern="^[\d()+-]+$" title="Please enter a valid phone number (digits, parentheses, plus, and hyphen only)">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="sn" class="form-label">Serial Number <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="A unique identifier for the invoice (e.g., INV-001). Optional."></i></label>
                                        <input type="text" class="form-control" id="sn" placeholder="e.g., INV-2025-001">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="dt" class="form-label">Date <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The date the invoice is issued. Defaults to today."></i></label>
                                        <input type="date" class="form-control" id="dt">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="st" class="form-label">Send Type <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The desired output format or delivery method."></i></label>
                                        <!-- Custom Send Type Dropdown Structure -->
                                        <div class="custom-select-wrapper">
                                            <div id="custom-st-select-trigger" class="form-control custom-select-trigger">
                                                <span id="selected-st-name">Download PDF</span>
                                                <i class="bi bi-chevron-down dropdown-arrow"></i>
                                            </div>
                                            <div id="custom-st-select-options" class="custom-select-options">
                                                <!-- Options will be populated by JavaScript -->
                                            </div>
                                        </div>
                                        <!-- Original select element (hidden) to hold the actual value for form submission -->
                                        <select id="st" class="form-select d-none">
                                            <option value="dl">Download PDF</option>
                                            <option value="ep" disabled>Email PDF (Coming Soon)</option>
                                            <option value="eh" disabled>Email HTML (Coming Soon)</option>
                                        </select>
                                    </div>
                                </div>
                                <div id="recipientEmailField" class="mt-3">
                                    <label for="re" class="form-label">Recipient Email <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The email address to send the invoice to."></i></label>
                                    <input type="email" class="form-control" id="re" placeholder="recipient@example.com">
                                    <small class="form-text text-muted mt-2">Emails will be sent via Solven.app's secure service.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="col-lg-7">
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header d-flex align-items-center">
                                <i class="bi bi-person-lines-fill me-2"></i><h5 class="mb-0">Bill To Details</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="bt_cp" class="form-label">Company Name <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The name of the company receiving the invoice."></i></label>
                                        <input type="text" class="form-control" id="bt_cp" placeholder="Recipient's Company">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="bt_ad" class="form-label">Address <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The recipient's physical or mailing address."></i></label>
                                        <input type="text" class="form-control" id="bt_ad" placeholder="Recipient's Address">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="bt_ph" class="form-label">Phone <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="A contact phone number for the recipient."></i></label>
                                        <input type="tel" class="form-control" id="bt_ph" placeholder="Recipient's Phone" pattern="^[\d()+-]+$" title="Please enter a valid phone number (digits, parentheses, plus, and hyphen only)">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card mb-4 shadow-sm">
                            <div class="card-header d-flex align-items-center">
                                <i class="bi bi-credit-card me-2"></i><h5 class="mb-0">Billing Structure</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Payment Method <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="The method by which payment should be made."></i></label>
                                    <div id="pm-btn-group" class="btn-group w-100">
                                        <button type="button" class="btn btn-outline-primary active" data-value="bd">
                                            <i class="bi bi-bank"></i><span class="button-text">Bank Details</span>
                                        </button>
                                        <button type="button" class="btn btn-outline-primary" data-value="pp">
                                            <i class="bi bi-paypal"></i><span class="button-text">PayPal</span>
                                        </button>
                                        <button type="button" class="btn btn-outline-primary" data-value="pl">
                                            <i class="bi bi-link-45deg"></i><span class="button-text">Payment Link</span>
                                        </button>
                                        <button type="button" class="btn btn-outline-primary" data-value="ot">
                                            <i class="bi bi-three-dots"></i><span class="button-text">Other</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="payment-details-container mt-3">
                                    <div id="bankDetailsFields">
                                        <div class="row">
                                            <div class="col-md-6 mb-3">
                                                <label for="pm_bn" class="form-label">Bank Name</label>
                                                <input type="text" class="form-control" id="pm_bn" value="Global Bank">
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <label for="pm_sc" class="form-label">Swift Code</label>
                                                <div class="position-relative">
                                                    <input type="text" class="form-control" id="pm_sc" value="GLBLBNKXX" pattern="[A-Za-z]{8,11}" title="Swift Code must be 8 to 11 letters." minlength="8" maxlength="11">
                                                    <span class="validation-icon-hidden position-absolute" id="pm_sc_invalid_icon" data-bs-toggle="tooltip" title="Swift Code must be 8-11 characters."><i class="bi bi-info-circle-fill text-danger"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6 mb-3">
                                                <label for="pm_an" class="form-label">Account No.</label>
                                                <input type="text" class="form-control" id="pm_an" value="987654321">
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <label for="pm_rn" class="form-label">Routing Number</label>
                                                <input type="text" class="form-control" id="pm_rn" value="021000021">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6 mb-3">
                                                <label for="pm_br" class="form-label">Branch</label>
                                                <input type="text" class="form-control" id="pm_br" value="Downtown">
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <label for="pm_ai" class="form-label">Additional Details</label>
                                                <textarea class="form-control" id="pm_ai" rows="3" placeholder="e.g., Reference #"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="paypalFields">
                                        <div class="mb-3">
                                            <label for="pm_em" class="form-label">PayPal Email</label>
                                            <input type="email" class="form-control" id="pm_em" value="billing@solven.app">
                                        </div>
                                    </div>
                                    <div id="paymentLinkFields">
                                        <div class="mb-3">
                                            <label for="pl_url" class="form-label">Payment Link</label>
                                            <input type="url" class="form-control" id="pl_url" placeholder="https://example.com/pay">
                                        </div>
                                    </div>
                                    <div id="otherPaymentNote" class="mt-3">
                                        <p class="text-muted">For 'Other' payment methods, please provide details in the Additional Notes section below.</p>
                                        <button type="button" id="scrollToNotesBtn" class="btn btn-primary"><i class="bi bi-arrow-down-circle me-1"></i>Go to Additional Notes</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Invoice Items and General Notes Section (Full Width, Centered) -->
                <div class="row justify-content-center mt-4">
                    <div class="col-lg-10"> <!-- Adjust col-lg-* to control max-width -->
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="bi bi-list-ul me-2"></i>Invoice Items</h5>
                            </div>
                            <div class="card-body position-relative">
                                <div class="mb-4">
                                    <label class="form-label">Invoice Type <i class="bi bi-question-circle-fill ms-1" data-bs-toggle="tooltip" title="'One-Time' for standard invoices. 'Monthly' for subscription-style line items."></i></label>
                                    <div id="it-btn-group" class="btn-group w-100">
                                        <button type="button" class="btn btn-outline-primary active" data-value="oneTimePayment">
                                            <i class="bi bi-cash-coin"></i><span class="button-text">One-Time Payment</span>
                                        </button>
                                        <button type="button" class="btn btn-outline-primary" data-value="monthlyPayment">
                                            <i class="bi bi-calendar-check"></i><span class="button-text">Monthly</span>
                                        </button>
                                    </div>
                                </div>
                                <div id="invoiceListItems"></div>
                                <button type="button" id="addInvoiceItem" class="btn btn-primary"><i class="bi bi-plus-lg"></i></button>
                            </div>
                        </div>

                        <div class="card mb-4 shadow-sm">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-journal-text me-2"></i>General Invoice Notes</h5>
                            </div>
                            <div class="card-body">
                                <textarea id="an" class="form-control" rows="3" placeholder="Any extra details or terms..."></textarea>
                            </div>
                        </div>

                        <div class="d-grid mb-4">
                            <button type="submit" form="apiForm" class="btn btn-primary btn-lg"><i class="bi bi-arrow-right-circle me-2"></i>Generate Invoice</button>
                        </div>
                    </div>
                </div>
            </form>
        </main>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="prereg.js"></script>
    <script type="module" src="api.js"></script>
    <script type="module" src="script.js"></script>
    <script type="module" src="favicon-switcher.js"></script>
    <!-- Image Preview Modal -->
    <div class="modal fade" id="imagePreviewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-md">
            <div class="modal-content bg-transparent border-0 position-relative">
                <img src="" id="modalImagePreview" class="img-fluid rounded" alt="Template Preview">
                <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
        </div>
    </div>

    <!-- Pre-registration Modal -->
    <div class="modal fade" id="preregModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="countdown-timer"></div>
                    <p>Hurry! Sign up before the countdown ends and unlock lifetime free access to Invoiza.</p>
                    <button type="button" id="reserveSpotBtn" class="btn btn-primary btn-lg">Reserve my spot</button>
                    <button type="button" id="giveUpBtn" class="mt-3">Give up</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
